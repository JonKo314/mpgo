<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <title>My test page</title>

  <style>
    line,
    circle {
      stroke-width: .2;
      stroke-linecap: square;
    }

    line {
      stroke: black;
    }

    circle.black {
      fill: black;
      stroke: black;
    }

    circle.white {
      fill: white;
      stroke: black;
    }
  </style>

  <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
</head>

<body>
  <div id="app">
    <p>{{ message }}</p>
    <svg viewBox="0 0 100 100" height="400" widht="400">
      <circle v-for="mark in marks" v-bind:cx="mark.x" v-bind:cy="mark.y" r="1" />
      <g v-for="tile in tiles">
        <line v-if="tile.north" v-bind:x1="tile.x" v-bind:y1="tile.y" v-bind:x2="tile.x" v-bind:y2="tile.y - 5" />
        <line v-if="tile.east" v-bind:x1="tile.x" v-bind:y1="tile.y" v-bind:x2="tile.x + 5" v-bind:y2="tile.y" />
        <line v-if="tile.south" v-bind:x1="tile.x" v-bind:y1="tile.y" v-bind:x2="tile.x" v-bind:y2="tile.y + 5" />
        <line v-if="tile.west" v-bind:x1="tile.x" v-bind:y1="tile.y" v-bind:x2="tile.x - 5" v-bind:y2="tile.y" />
        <circle v-bind:cx="tile.x" v-bind:cy="tile.y" r="4" fill-opacity="0" v-on:click="tileClick(tile)" />
      </g>
      <circle v-for="stone in stones" v-bind:class="stone.team" v-bind:cx="10 * stone.x" v-bind:cy="10 * stone.y"
        r="4.5" />
    </svg>
  </div>
</body>

<script>
  var app = new Vue({
    el: '#app',
    data: {
      message: 'Hello Vue!',
      stones: [],
      marks: [
        { x: 30, y: 30 },
        { x: 70, y: 30 },
        { x: 50, y: 50 },
        { x: 30, y: 70 },
        { x: 70, y: 70 },
      ],
      tiles: []
    },

    created: function () {
      this.createTiles();
      this.getStones();
    },

    methods: {
      createTiles: function () {
        const rows = 9;
        const columns = 9;
        for (let row = 1; row <= rows; ++row) {
          for (let column = 1; column <= columns; ++column) {
            this.tiles.push({
              x: column * 10,
              y: row * 10,
              north: row > 1,
              east: column < columns,
              south: row < rows,
              west: column > 1
            });
          }
        }
      },

      getStones: function () {
        fetch('http:\\localhost:3000', {
          method: 'GET',
          mode: 'cors',
          cache: 'reload'
        }).then((response) => {
          if (response.status === 200) {
            return response.json();
          }

          return Promise.reject(new Error(
            response.statusText + '(' + response.status + ')'
          ));
        }).then((stones) => {
          this.stones = stones;
        }).catch((error) => {
          alert(error);
          console.log(error);
        });
      },

      tileClick: function (tile) {
        this.stones.push({ x: tile.x, y: tile.y, team: 'black' })
      }
    }
  })
</script>

</html>